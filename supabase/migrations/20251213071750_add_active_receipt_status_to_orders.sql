/*
  # Додавання статусу "в активному прийомі" до замовлень

  ## Зміни
  
  1. Constraint
    - Додається новий статус "в активному прійомі" до CHECK constraint поля status
    - Цей статус використовується коли замовлення додається до активної прийомки
  
  2. Логіка
    - Дозволяє системі автоматично змінювати статус при роботі з прийомками
*/

-- Видаляємо старий constraint
ALTER TABLE orders DROP CONSTRAINT IF EXISTS orders_status_check;

-- Додаємо новий constraint з додатковим статусом
ALTER TABLE orders ADD CONSTRAINT orders_status_check 
  CHECK (
    status IS NULL OR 
    status IN (
      'в роботі на сьогодні',
      'на броні',
      'очікується',
      'прийнято сьогодні',
      'на складі',
      'в дорозі',
      'в вигрузці',
      'готово до відправки',
      'повернення',
      'проблемні',
      'анульовано',
      'в активному прийомі'
    )
  );