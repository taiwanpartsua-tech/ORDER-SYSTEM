/*
  # Виправлення обмеження для status

  ## Зміни
  Оновлюємо обмеження CHECK для поля status в таблиці orders,
  щоб підтримувати всі українські статуси, які використовує фронтенд:
  - 'в роботі на сьогодні'
  - 'на броні'
  - 'очікується'
  - 'прийнято сьогодні'
  - 'на складі'
  - 'в дорозі'
  - 'в вигрузці'
  - 'готово до відправки'
  - 'повернення'
  - 'проблемні'
  - 'анульовано'

  ## Примітки
  Видаляємо старе англійське обмеження та створюємо нове з українськими значеннями.
*/

-- Видалення старого обмеження, якщо воно існує
DO $$
BEGIN
  IF EXISTS (
    SELECT 1 FROM pg_constraint 
    WHERE conname = 'orders_status_check'
  ) THEN
    ALTER TABLE orders DROP CONSTRAINT orders_status_check;
  END IF;
END $$;

-- Додавання нового обмеження з українськими значеннями
ALTER TABLE orders 
ADD CONSTRAINT orders_status_check 
CHECK (status IS NULL OR status IN (
  'в роботі на сьогодні',
  'на броні',
  'очікується',
  'прийнято сьогодні',
  'на складі',
  'в дорозі',
  'в вигрузці',
  'готово до відправки',
  'повернення',
  'проблемні',
  'анульовано'
));